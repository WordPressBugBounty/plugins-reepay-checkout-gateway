jQuery((function(a){const t=a(".migration-mobilepay-to-vippsmobile-wrap"),i=t.find(".spinners_warp"),e=t.find(".result");function o(t,n){a.ajax({url:ajaxurl,type:"POST",data:{action:"reepay_migration_process_batch",offset:t},success:function(r){if(r.success){var s=r.data.processed/n*100;a(".processing-percentage").html(s.toFixed(0)+"%"),r.data.has_more?o(t+10,n):(e.html(migrationData.processed_success),a(".processing-percentage").html("0%"),a(".start-migration").prop("disabled",!1),a("#migration_file").val(""),i.hide())}else alert(migrationData.processed_failed)}})}e.html(""),t.on("change","#migration_file",(function(t){e.html("");const i=a(this),o=i[0].files[0];o&&o.name.endsWith(".csv")||(e.html(migrationData.upload_csv),i.val(""))})),t.on("click",".start-migration",(function(t){if(t.preventDefault(),e.html(""),!confirm(migrationData.confirm_migration))return;const n=a("#migration_file"),r=a(this);if(n.val()){r.prop("disabled",!0),i.show();var s=new FormData;s.append("action","reepay_migration_upload_csv"),s.append("migration_file",a("#migration_file")[0].files[0]),a.ajax({url:ajaxurl,type:"POST",data:s,processData:!1,contentType:!1,success:function(a){a.success?o(0,a.data.total_records):alert(migrationData.failed_upload)}})}else alert(migrationData.choose_file)}))}));