jQuery((function(e){"use strict";let o=!1,t=new Set;e("#add_payment_method").on("submit",(function(t){const n=e(this),s=n.find('button[type="submit"], input[type="submit"]');if(o)return t.preventDefault(),!1;const i=n.find('input[name="payment_method"]:checked').val();i&&-1!==i.indexOf("reepay")&&(o=!0,s.prop("disabled",!0).addClass("processing"),s.hasClass("blocked")||s.text(s.text()+"..."),setTimeout((function(){o=!1,s.prop("disabled",!1).removeClass("processing")}),1e4))})),e(window).on("beforeunload",(function(){o=!1})),e(document).ajaxSend((function(e,o,n){if(n.url&&-1!==n.url.indexOf("reepay_card_store")){const e=new URLSearchParams(n.url.split("?")[1]).get("payment_method");if(e&&t.has(e))return o.abort(),console.warn("Reepay: Duplicate payment method submission prevented"),!1;e&&(t.add(e),setTimeout((function(){t.delete(e)}),3e4))}})),e(document).ajaxComplete((function(t,n,s){if(s.url&&-1!==s.url.indexOf("reepay_card_store")){o=!1;e("#add_payment_method").find('button[type="submit"], input[type="submit"]').prop("disabled",!1).removeClass("processing")}})),e(".woocommerce .payment-method-actions .button").on("click",(function(o){const t=e(this);if(t.hasClass("disabled")||t.hasClass("processing"))return o.preventDefault(),!1;t.addClass("processing disabled"),setTimeout((function(){t.removeClass("processing disabled")}),5e3)}));const n=new MutationObserver((function(n){n.forEach((function(n){if("childList"===n.type){e(".woocommerce-message, .woocommerce-error").length>0&&(o=!1,t.clear(),e(".button.processing").removeClass("processing disabled").prop("disabled",!1))}}))})),s=document.querySelector(".woocommerce-notices-wrapper, .woocommerce");s&&n.observe(s,{childList:!0,subtree:!0}),window.console&&window.console.log&&console.log("Reepay: Add Payment Method Protection loaded")}));